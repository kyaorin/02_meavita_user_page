<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/sanitize.css" />
    <link rel="stylesheet" href="css/style.css" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <title>ミアビータ会員専用ページ</title>
</head>

<body>

    <main>

        <div class="button_row_1">
            <img id="word" src="img/word_top.png" alt="人生に影響を与えた本と名言集">
            <img id="QA" src="img/QA_top.png" alt="１日１問">
            <div class="memo_wrapper">
                <input class="calender" type="date" id="calender">
                <input type="text" id="input" placeholder="ex. 今日の問い、今抱えているモヤモヤ etc">
                <textarea id="text_area"
                    placeholder="ex. 今日の問いに対する自分なりの答え、今抱えている悩み、モヤモヤ、感じていることなどを思いつくまま、自由に記入してみよう！　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　【使い方】①記入をしたら、その日の曜日ボタンを押して内容を保存してね。　　　　②別の日を記入する際は、消すボタンを押してね。　　　　③１週間記入をして振返ボタンをクリックすると、１週間の振り返りシートが表示されるよ。"></textarea>
                <div class="memo_btn_wrapper">
                    <button id="mon">月</button>
                    <button id="tue">火</button>
                    <button id="wed">水</button>
                    <button id="thr">木</button>
                    <button id="fri">金</button>
                    <button id="sat">土</button>
                    <button id="sun">日</button>
                    <button id="clear">消す</button>
                    <button id="week">振返</button>
                    <button id="next">翌週へ</button>
                </div>
            </div>
        </div>


    </main>

    <script>

        //////////////////////////////////////////////////////
        ///// メモ書き部分
        ///// 1日１問、質問やテーマに対する気付きや感情を記録し
        ///// １週間ごと振り返りと合わせてダウンロードできるようにしたい
        //////////////////////////////////////////////////////

        //月曜〜日曜のsaveしたデータをストックしていく配列
        const weeklist = [];

        $("#mon").on("click", function () {
            const when = $("#calender").val();
            const input = $("#input").val();
            const text = $("#text_area").val();
            const mondata = {
                when: when,
                title: input,
                text: text,
            };
            weeklist[0] = mondata; // "mondata"を"weeklist"の[0]の要素に設定
            console.log(weeklist);
            const json = JSON.stringify(weeklist);
            console.log(json);
            localStorage.setItem("weeklist", json);
        });

        $("#tue").on("click", function () {
            const when = $("#calender").val();
            const input = $("#input").val();
            const text = $("#text_area").val();
            const tuedata = {
                when: when,
                title: input,
                text: text,
            };
            weeklist[1] = tuedata; // "tuedata"を"weeklist"の[1]の要素に設定
            console.log(weeklist);
            const json = JSON.stringify(weeklist);
            console.log(json);
            localStorage.setItem("weeklist", json);
        });

        $("#wed").on("click", function () {
            const when = $("#calender").val();
            const input = $("#input").val();
            const text = $("#text_area").val();
            const weddata = {
                when: when,
                title: input,
                text: text,
            };
            weeklist[2] = weddata; // "weddata"を"weeklist"の[2]の要素に設定
            console.log(weeklist);
            const json = JSON.stringify(weeklist);
            console.log(json);
            localStorage.setItem("weeklist", json);
        });

        $("#thr").on("click", function () {
            const when = $("#calender").val();
            const input = $("#input").val();
            const text = $("#text_area").val();
            const thrdata = {
                when: when,
                title: input,
                text: text,
            };
            weeklist[3] = thrdata; // "thrdata"を"weeklist"の[3]の要素に設定
            console.log(weeklist);
            const json = JSON.stringify(weeklist);
            console.log(json);
            localStorage.setItem("weeklist", json);
        });

        $("#fri").on("click", function () {
            const when = $("#calender").val();
            const input = $("#input").val();
            const text = $("#text_area").val();
            const fridata = {
                when: when,
                title: input,
                text: text,
            };
            weeklist[4] = fridata; // "fridata"を"weeklist"の[4]の要素に設定
            console.log(weeklist);
            const json = JSON.stringify(weeklist);
            console.log(json);
            localStorage.setItem("weeklist", json);
        });

        $("#sat").on("click", function () {
            const when = $("#calender").val();
            const input = $("#input").val();
            const text = $("#text_area").val();
            const satdata = {
                when: when,
                title: input,
                text: text,
            };
            weeklist[5] = satdata; // "satdata"を"weeklist"の[5]の要素に設定
            console.log(weeklist);
            const json = JSON.stringify(weeklist);
            console.log(json);
            localStorage.setItem("weeklist", json);
        });

        $("#sun").on("click", function () {
            const when = $("#calender").val();
            const input = $("#input").val();
            const text = $("#text_area").val();
            const sundata = {
                when: when,
                title: input,
                text: text,
            };
            weeklist[6] = sundata; // "sundata"を"weeklist"の[6]の要素に設定
            console.log(weeklist);
            const json = JSON.stringify(weeklist);
            console.log(json);
            localStorage.setItem("weeklist", json);
        });

        //クリアボタンを押すと、ローカルデータは残したまま、入力エリアのデータが消える
        $("#clear").on("click", function () {
            //localStorage.removeItem("mon");
            $("#calender").val("");
            $("#input").val("");
            $("#text_area").val("");
        });


        //next（翌週へ）ボタンをクリックすると、ローカルのデータ＆入力データともに消える
        $("#next").on("click", function () {
            localStorage.removeItem("weeklist");
            $("#calender").val("");
            $("#input").val("");
            $("#text_area").val("");
        });

        //ここまでは完了！頑張った！残りはここ！


        //week（振返）ボタンを押すと、Localに保存されていたweeklistのデータが引き出されて
        //１週間の振返りリストに反映される

        $("#week").on("click", function () {
            // localStorageからweeklistを取得し、JSON形式からJavaScriptオブジェクトに変換
            const json = localStorage.getItem("weeklist");
            console.log(json);
            const review_weeklist = JSON.parse(json);
            console.log(review_weeklist);

            const pull_mondata = review_weeklist[0]; // weeklistの[0]の要素を取得
            const pull_tuedata = review_weeklist[1]; // weeklistの[1]の要素を取得
            const pull_weddata = review_weeklist[2]; // weeklistの[2]の要素を取得
            const pull_thrdata = review_weeklist[3]; // weeklistの[3]の要素を取得
            const pull_fridata = review_weeklist[4]; // weeklistの[4]の要素を取得
            const pull_satdata = review_weeklist[5]; // weeklistの[5]の要素を取得
            const pull_sundata = review_weeklist[6]; // weeklistの[6]の要素を取得

            $("#mon_date").data(pull_mondata.when); // "#mon_date"にpull_mondataのwhenを表示
            $("#mon_text").text(pull_mondata.title); // "#mon_text"にpull_mondataのtitleを表示
            $("#montext_area").text(pull_mondata.text); // "#montext_area"にpull_mondataのtextを表示
        });


    </script>

</body>